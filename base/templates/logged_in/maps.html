{% extends 'base.html' %}
{% block content %}
<script src='https://api.mapbox.com/mapbox-gl-js/v0.40.0/mapbox-gl.js'></script>
<link href='https://api.mapbox.com/mapbox-gl-js/v0.40.0/mapbox-gl.css' rel='stylesheet' />
<style>
  body {
    margin: 0;
    padding: 0;
  }

  #map {
    position: relative;
    top: 0;
    bottom: 0;
    width: 100%;
  }
</style>

<div id="page-wrapper">
    <div class="col-lg-12">
    <h1 class = "page-header">Map</h1>
    </div>
    <div col-md-6>
    <div id='map' style='width: 100%; height: 75%;'></div>
        <script>
          mapboxgl.accessToken = 'pk.eyJ1IjoidHJhc2hyIiwiYSI6ImNqOHJ3MDBzZjAyZTgzNG1yNHpmZDl3Y2sifQ.q574EBc3GMSMHBH2sPGM6w';
          var map = new mapboxgl.Map({
            container: 'map', // container id
            style: 'mapbox://styles/trashr/cj966m1fm1kgm2stfxy2oejkh', // stylesheet location
            zoom: 13.7,
            center: [-78.681,35.781]
          });
          map.on('click', function(e) {
            var features = map.queryRenderedFeatures(e.point, {
              layers: ['{ncsu-dumpsters}'] // replace this with the name of the layer
            });

            if (!features.length) {
              return;
            }

            var feature = features[0];

            var popup = new mapboxgl.Popup({ offset: [0, -15] })
            .setLngLat(feature.geometry.coordinates)
            .setHTML('<h3>' + feature.properties.title + '</h3><p>' + feature.properties.description + '</p>')
            .setLngLat(feature.geometry.coordinates)
            .addTo(map);
            })
        </script>
    </div>
</div>
{% endblock %}
